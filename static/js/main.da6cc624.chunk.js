(this["webpackJsonpidb_front_2.0"]=this["webpackJsonpidb_front_2.0"]||[]).push([[0],{134:function(e,t,n){e.exports={wrapper:"SearchMenu_wrapper__2vmIX",title:"SearchMenu_title__1N2wc",select:"SearchMenu_select__RUOgL"}},175:function(e,t,n){e.exports={sider:"MainMenu_sider__1dgcG",menu:"MainMenu_menu__2qS9s",keywordsMenuWrapper:"MainMenu_keywordsMenuWrapper__38MV-"}},177:function(e,t,n){e.exports={folderWrapper:"Folders_folderWrapper__3lCdj",label:"Folders_label__t92FN",plusIcon:"Folders_plusIcon__W5-Yt"}},178:function(e,t,n){e.exports={item:"EditMenu_item__19rVS",itemWidth:"EditMenu_itemWidth__3oZad",extension:"EditMenu_extension__3PUWD"}},217:function(e,t,n){e.exports={dropZone:"DropZone_dropZone__21dpH"}},221:function(e,t,n){e.exports={alert:"CustomAlert_alert__24dHy"}},335:function(e,t,n){},336:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(31),r=n.n(i),c=n(90),s=n(20),o=n(34),l=n(349),u=n(23),d=n(364),j=n(359),f=n(362),b=n(368),p=n(346),O=n(347),m=n(223),h=n(60),g=n(210),x=n(342),y=n(367),v=n(126),w=n(53),P=n.n(w),L=n(230),F=n(338),S=n(339),_=n(340),M=n(341),k=n(343),N=n(231),E=n(344),D=n(345),T="YYYY.MM.DD",K=(m.a,function(e){return JSON.parse(JSON.stringify(e))}),C=function(e){return e.endsWith("/")?e.slice(0,-1):e},A=function(e){return e.startsWith("/")?e.slice(1):e},I=function(e){return e[e.length-1]},U=function(e){return e&&"-"!==e?function(e){var t=e.split(".");return{shortName:t.slice(0,-1).join("."),ext:"."+t[t.length-1]}}(e):{shortName:"-",ext:""}},R=function(e,t){var n,a=e[t],i=(null===a||void 0===a?void 0:a.DateTimeOriginal)?(n=null===a||void 0===a?void 0:a.DateTimeOriginal,P()(n,"YYYY:MM:DD hh:mm:ss").format(T)):"-";return{keywords:(null===a||void 0===a?void 0:a.Keywords)||null,megapixels:(null===a||void 0===a?void 0:a.Megapixels)||"",originalDate:i,tempPath:t}},W=function(e,t,n){return t.map((function(t){return t[e]===n[e]?Object(u.a)(Object(u.a)({},t),n):t}))},G=function(e){return function(e){var t=e.reduce((function(e,t){var n=e[t]?Object(F.a)(e[t]):1;return Object(u.a)(Object(u.a)({},K(e)),{},Object(v.a)({},t,n))}),{}),n=Object(L.a)((function(e){return 1===e}),t);return Object(_.a)((function(e,t){var n=e[t]?Object(S.a)(e[t]):t,a=Object(u.a)(Object(u.a)({},K(e)),{},Object(v.a)({},t,n)),i=e[t]?"_".concat(e[t].toString().padStart(3,"0")):"";return[a,"".concat(t).concat(i)]}),n,e)[1]}(e.map((function(e){return e.shortName}))).map((function(t,n){return{shortName:t,ext:e[n].ext}}))},B=function(e){var t=K(e),n=t.map((function(e){var t=e.name;return U(t)})),a=G(n);return t.map((function(e,t){var n=a[t],i=n.shortName,r=n.ext;return Object(u.a)(Object(u.a)({},e),{},{name:i+r})}))},Y=function(e,t){return t.map((function(t){return Object(u.a)(Object(u.a)({},t),{},{keywords:Object(M.a)(e,t.keywords||[])})}))},q=function(e,t){return t.map((function(t){return Object(u.a)(Object(u.a)({},t),{},{keywords:Object(x.a)(e,t.keywords||[])})}))},z=function(e,t,n){return t.map((function(t){return a=t[e],n.find((function(t){return t[e]===a}))||t;var a}))},Z=function(e,t){var n=Object(k.a)(N.a);return Object(m.a)((function(e){return e.length?e.reduce((function(e,t){return Object(E.a)(e,t)})):[]}),Object(y.a)((function(e){return e.keywords||[]})),n((function(e,n){return Object(D.a)(n,t)})))(e)},J=function(e){return e.map((function(e){return function(e){var t=e.originalName,n=e.mimetype;return Object(u.a)(Object(u.a)({},Object(p.a)(["mimetype","originalName"],e)),{},{name:t,type:n})}(e)}))},V=function(e){return e.split("/").slice(0,-1).join("/")},H=function(e){return e.folderReducer},Q=function(e){return e.folderReducer.pathsArr},X=function(e){return e.uploadReducer},$=function(e){return e.uploadReducer.uploadingFiles},ee=function(e){return e.mainPageReducer},te=function(e){return e.mainPageReducer.downloadingFiles},ne=function(e){return e.mainPageReducer.galleryPagination},ae=Object(h.a)(Q,(function(e){return e.map((function(e){return{value:e}}))})),ie=Object(h.a)(X,(function(e){var t=e.uploadingFiles,n=e.selectedList;return{openMenus:e.openMenus,selectedList:n,fullExifFilesList:e.fullExifFilesList,imageArr:t}})),re=Object(h.a)(ee,X,(function(e,t){var n=e.downloadingFiles,a=e.dSelectedList;return{openMenus:e.dOpenMenus,selectedList:a,fullExifFilesList:t.fullExifFilesList,imageArr:n}})),ce=Object(h.a)($,(function(e){return Object(m.a)((function(e){return Object(g.a)(x.a,[],e)}),Object(y.a)((function(e){return e.keywords||[]})))(e)})),se=Object(h.a)(te,(function(e){return Object(m.a)((function(e){return Object(g.a)(x.a,[],e)}),Object(y.a)((function(e){return e.keywords||[]})))(e)})),oe=Object(h.a)($,(function(e){return e.uploadReducer.selectedList}),(function(e,t){return Z(e,t)})),le=Object(h.a)(te,(function(e){return e.mainPageReducer.dSelectedList}),(function(e,t){return Z(e,t)})),ue=n(185),de=n.n(ue),je=n(211),fe=n(72),be=n(91),pe=n(212),Oe=n.n(pe).a.create({baseURL:"http://localhost:5000",headers:{"Content-Type":"multipart/form-data"}}),me={sendPhotos:function(e,t){return Oe.post("/upload?path=".concat(t),e,{headers:{"Content-Type":"application/json"}})},updatePhotos:function(e){return Oe.put("/update",e,{headers:{"Content-Type":"application/json"}})},sendPhoto:function(e){var t=new FormData;return t.append("filedata",e),Oe.post("/uploadItem",t)},getKeywordsList:function(){return Oe.get("/keywords")},getPathsList:function(){return Oe.get("/paths")},getKeywordsFromPhoto:function(e){return Oe.post("/image-exif",e,{headers:{"Content-Type":"application/json"}})},getPhotosByTags:function(e,t,n,a,i){var r={page:e,perPage:t,searchTags:n,excludeTags:a,folderPath:i};return Oe.post("/filtered-photos",r,{headers:{"Content-Type":"application/json"}})}},he=n(227),ge=function(e,t,n){he.a.error({message:t,description:e.message,duration:void 0===n?4.5:n})},xe=Object(fe.b)({name:"upload",initialState:{uploadingFiles:[],fullExifFilesList:{},selectedList:[],openMenus:["folders"],isExifLoading:!1,uploadingStatus:"empty"},reducers:{addUploadingFile:function(e,t){e.uploadingFiles.push(t.payload)},updateUploadingFilesArr:function(e,t){e.uploadingFiles=t.payload},addFullExifFile:function(e,t){var n=t.payload,a=n.tempPath,i=n.fullExifObj;e.fullExifFilesList[a]=i},updateFullExifFile:function(e,t){e.fullExifFilesList=Object(u.a)(Object(u.a)({},e.fullExifFilesList),t.payload)},addToSelectedList:function(e,t){var n=new Set(e.selectedList);n.add(t.payload),e.selectedList=Array.from(n)},removeFromSelectedList:function(e,t){var n=new Set(e.selectedList);n.delete(t.payload),e.selectedList=Array.from(n)},clearSelectedList:function(e){e.selectedList=[]},selectAll:function(e){e.selectedList=e.uploadingFiles.map((function(e,t){return t}))},updateOpenMenus:function(e,t){e.openMenus=t.payload},removeFromOpenMenus:function(e,t){var n=new Set(e.openMenus);n.delete(t.payload),e.openMenus=Array.from(n)},clearUploadingState:function(e){e.uploadingFiles=[],e.selectedList=[],e.fullExifFilesList={}},setLoading:function(e,t){e.isExifLoading=t.payload},setUploadingStatus:function(e,t){e.uploadingStatus=t.payload}}}),ye=xe.actions,ve=ye.addUploadingFile,we=ye.updateUploadingFilesArr,Pe=(ye.addFullExifFile,ye.updateFullExifFile),Le=ye.addToSelectedList,Fe=ye.removeFromSelectedList,Se=ye.clearSelectedList,_e=ye.selectAll,Me=ye.updateOpenMenus,ke=(ye.removeFromOpenMenus,ye.clearUploadingState),Ne=ye.setLoading,Ee=ye.setUploadingStatus,De=xe.reducer,Te=function(e){return function(){var t=Object(je.a)(de.a.mark((function t(n,a){return de.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,me.getKeywordsFromPhoto(e).then((function(e){var t=e.data;n(Pe(t));var i=a().uploadReducer,r=i.uploadingFiles,c=i.fullExifFilesList,s=Object(O.a)(R)(c),o=function(e,t){var n=Object(O.a)(W)("tempPath")(e);return Object(m.a)(n,s)(t)},l=Object(m.a)((function(e){return Object(g.a)(o,r,e)}),be.a)(t);n(we(l))})).catch((function(e){ge(e,"Error when getting Exif: ")}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},Ke=n(96),Ce=n(40),Ae=n(348),Ie=n(232),Ue=function(e,t){return"parent"===e?t+"-0":function(){var e=t.split("-");return"".concat(e.slice(0,-1).join("-"),"-").concat(+e.slice(-1)+1)}()},Re=function(e,t){return!e.children&&t.length>1&&e.title===t[0]?function(e,t){var n=e.title,a=e.key;return{title:n,key:a,children:[{title:t,key:Ue("parent",a)}]}}(e,t[1]):e},We=function(e,t){return e.some((function(e){return e.title===t[0]}))||0===t.length?e:function(e,t){var n={title:e,key:Ue("sibling",t.slice(-1)[0].key)};return[].concat(Object(Ke.a)(K(t)),[n])}(t[0],e)},Ge=function(e,t){var n=e.split("/");return function e(t,n){return We(n,t).map((function(n){var a=Re(n,t),i=a.title,r=a.key,c=a.children;return t.length>1&&n.title===t[0]?{title:i,key:r,children:e(t.slice(1),c||[])}:n}))}(n,t.length?t:[{title:n[0],key:"0-0"}])},Be=function e(t,n){var a=t.find((function(e){return n.startsWith(e.key)})),i=a?function(t,n){var a=n.children,i=n.title;return a?"".concat(i,"/").concat(e(a,t)):i}(n,a):"";return C(i)},Ye=function(e,t){var n=C(t);return Ge(n,e)},qe=Object(fe.b)({name:"folder",initialState:{folderTree:[],currentFolderPath:"",pathsArr:[],keywordsList:[]},reducers:{setFolderTree:function(e,t){e.folderTree=t.payload},setCurrentFolderPath:function(e,t){e.currentFolderPath=t.payload},setPathsArr:function(e,t){e.pathsArr=t.payload},setKeywordsList:function(e,t){e.keywordsList=t.payload}}}),ze=qe.actions,Ze=ze.setFolderTree,Je=ze.setCurrentFolderPath,Ve=ze.setPathsArr,He=ze.setKeywordsList,Qe=qe.reducer,Xe=function(){return function(e){var t=function(e,t){var n=C(t);return Ge(n,e)};me.getPathsList().then((function(n){var a,i=n.data;i.length&&e(Ve(i)),i.length&&e(Ze((a=i,Object(g.a)(t,[],a))))})).catch((function(e){return ge(e,"Error when getting Paths: ")}))}},$e=Object(fe.b)({name:"upload",initialState:{rawFiles:[],downloadingFiles:[],dSelectedList:[],dOpenMenus:[],searchTags:[],excludeTags:[],galleryPagination:{currentPage:1,nPerPage:60,resultsCount:0,totalPages:1},isExifLoading:!1,isGalleryLoading:!1},reducers:{setRawFiles:function(e,t){e.rawFiles=t.payload},setDownloadingFiles:function(e,t){e.downloadingFiles=t.payload},addToDSelectedList:function(e,t){var n=new Set(Object(Ce.a)(e).dSelectedList);n.add(t.payload),e.dSelectedList=Array.from(n)},removeFromDSelectedList:function(e,t){var n=new Set(e.dSelectedList);n.delete(t.payload),e.dSelectedList=Array.from(n)},updateDOpenMenus:function(e,t){e.dOpenMenus=t.payload},clearDSelectedList:function(e){e.dSelectedList=[]},selectAllD:function(e){e.dSelectedList=e.downloadingFiles.map((function(e,t){return t}))},setSearchTags:function(e,t){e.searchTags=t.payload},setExcludeTags:function(e,t){e.excludeTags=t.payload},setGalleryPagination:function(e,t){e.galleryPagination=Object(u.a)(Object(u.a)({},Object(Ce.a)(e).galleryPagination),t.payload)},clearDownloadingState:function(e){e.downloadingFiles=[],e.dSelectedList=[]},setDLoading:function(e,t){e.isExifLoading=t.payload},setDGalleryLoading:function(e,t){e.isGalleryLoading=t.payload}}}),et=$e.actions,tt=et.addToDSelectedList,nt=et.removeFromDSelectedList,at=et.setRawFiles,it=et.setDownloadingFiles,rt=et.updateDOpenMenus,ct=et.clearDSelectedList,st=et.selectAllD,ot=et.setSearchTags,lt=et.setExcludeTags,ut=et.clearDownloadingState,dt=et.setGalleryPagination,jt=(et.setDLoading,et.setDGalleryLoading),ft=$e.reducer,bt=function(e){return function(t,n){var a=n(),i=a.mainPageReducer,r=a.folderReducer,c=i.searchTags,s=i.excludeTags,o=i.galleryPagination,l=o.currentPage,u=o.nPerPage,d=Object(b.a)(c)?void 0:c,j=Object(b.a)(s)?void 0:s,f=r.currentFolderPath||void 0;t(jt(!0)),me.getPhotosByTags(e||l,u,d,j,f).then((function(e){var n=e.data,a=(null===n||void 0===n?void 0:n.files)||[],i=J(a);t(ct()),t(at(a)),t(it(i)),t(dt(n.searchPagination))})).catch((function(e){return ge(e,"downloading files error: ")})).finally((function(){return t(jt(!1))}))}},pt=function(e){return function(t,n){var a=n().folderReducer,i=function(e){var n=a.pathsArr,i=a.folderTree;t(Ve(Object(Ae.a)(Ie.a,[].concat(Object(Ke.a)(n),Object(Ke.a)(e))))),t(Ze(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(g.a)(Ye,t,e)}(e,i)))};t(jt(!0)),me.updatePhotos(e).then((function(e){var t,n=e.data,a=n.error,r=n.files,c=n.newFilePath;a&&ge(new Error(a),"updating files error: ",0),r&&c&&(t="Files updated successfully",he.a.success({message:"Success",description:t})),(null===c||void 0===c?void 0:c.length)&&i(c)})).catch((function(e){console.log("error",e),ge(e.error,"updating files error: ")})).finally((function(){return t(jt(!1))}))}},Ot=function(){var e="/upload"===Object(o.f)().pathname;return{isUploadingPage:e,isMainPage:!e,currentPageNumber:Object(a.useMemo)((function(){return e?"2":"1"}),[e])}},mt=function(e){var t=Object(s.b)(),n=Object(s.c)(X).fullExifFilesList,a=function(e){return!!n[e]},i=function(e){return!a(e)&&t(Te([e]))},r=function(){var n=e.map((function(e){return e.tempPath})).filter((function(e){return!a(e)}));return!!n.length&&t(Te(n))},c=function(e){return t(Ne(!0)),e.then((function(){return t(Ne(!1))}))};return{updateUploadingFiles:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?r():i(e);return n?c(n):Promise.resolve(!0)}}},ht=n(6),gt=l.a.Header,xt=j.a.Title,yt=function(){var e=Object(s.b)(),t=Object(s.c)(Q),n=Ot().currentPageNumber;return Object(a.useEffect)((function(){!t.length&&e(Xe())}),[e,t]),Object(ht.jsxs)(gt,{className:"d-flex justify-content-between align-items-center",children:[Object(ht.jsx)(xt,{children:"IDBase"}),Object(ht.jsxs)(f.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:[n],children:[Object(ht.jsx)(f.a.Item,{children:Object(ht.jsx)(c.b,{to:"/",children:"Main page"})},"1"),Object(ht.jsx)(f.a.Item,{children:Object(ht.jsx)(c.b,{to:"/upload",children:"Upload"})},"2")]})]})},vt=n(43),wt=n(350),Pt=n(121),Lt=n(59),Ft=n(174),St=n(370),_t=n(371),Mt=n(372),kt=n(373),Nt=n(3),Et=n.n(Nt),Dt=n(175),Tt=n.n(Dt),Kt=n(229),Ct=function(e){var t=e.keywords,n=e.removeKeyword,a=e.isUploadingPage;return Object(ht.jsx)("div",{children:Object(Ae.a)(Ie.a,t).map((function(e){return Object(ht.jsx)(Kt.a,{closable:a,onClose:function(){n(e)},children:e},e)}))})},At=l.a.Sider,It=f.a.SubMenu,Ut=function(e){var t=e.filesArr,n=e.selectedList,i=e.openKeys,r=e.updateOpenMenus,c=e.updateKeywords,o=e.removeKeyword,l=e.currentFolderPath,u=e.clearSelectedList,d=e.selectAll,j=e.isExifLoading,b=e.uniqKeywords,p=e.sameKeywords,O=e.removeFiles,m=Object(s.b)(),h=Object(s.c)(H).keywordsList,g=Object(a.useState)(!1),x=Object(vt.a)(g,2),y=x[0],v=x[1],w=Ot(),P=w.isUploadingPage,L=w.isMainPage;Object(a.useEffect)((function(){!h.length&&m((function(e){me.getKeywordsList().then((function(t){var n=t.data;return n.length&&e(He(n))})).catch((function(e){return ge(e,"Error when getting Keywords List: ")}))}))}),[h.length,m]);var F=function(e){var n=e.key;u();var a=new Set(i);"edit"===n&&a.delete("template"),"template"===n&&a.delete("edit"),"keywords"===n&&!y&&(v(!0),P&&t.length?c().then((function(){return v(!1)})):v(!1)),a.has(n)?a.delete(n):a.add(n),r(Array.from(a))},S=function(){return Object(ht.jsxs)("div",{className:Et()(Tt.a.keywordsMenuWrapper,"d-flex justify-content-center"),children:[y?Object(ht.jsx)(wt.a,{tip:"Loading..."}):Object(ht.jsx)(Ct,{keywords:b,removeKeyword:o,isUploadingPage:P}),y||b.length?"":Object(ht.jsx)(Pt.a,{})]})};return Object(ht.jsx)(At,{theme:"light",className:Tt.a.sider,width:"400",children:Object(ht.jsxs)(f.a,{mode:"inline",className:Tt.a.menu,defaultOpenKeys:i,openKeys:i,children:[Object(ht.jsx)(It,{icon:Object(ht.jsx)(Ft.a,{}),title:"Search",onTitleClick:F,children:Object(ht.jsx)(Dn,{})},"search"),Object(ht.jsx)(It,{icon:Object(ht.jsx)(St.a,{}),title:"Folders",onTitleClick:F,children:Object(ht.jsx)(Zt,{isMainPage:L})},"folders"),Object(ht.jsx)(It,{icon:Object(ht.jsx)(_t.a,{}),title:"Edit",onTitleClick:F,children:Object(ht.jsx)(wn,{filesArr:t,selectedList:n,sameKeywords:p,isExifLoading:j,allKeywords:h,isMainPage:L})},"edit"),Object(ht.jsx)(It,{icon:Object(ht.jsx)(Mt.a,{}),title:"Template",onTitleClick:F,children:Object(ht.jsx)(wn,{filesArr:t,selectedList:n,sameKeywords:p,selectAll:d,isExifLoading:j,allKeywords:h,clearAll:u,isEditMany:!0,isMainPage:L})},"template"),Object(ht.jsx)(It,{icon:Object(ht.jsx)(kt.a,{}),title:"Keywords",onTitleClick:F,children:Object(ht.jsx)(S,{})},"keywords"),P?Object(ht.jsx)(f.a.Item,{children:Object(ht.jsxs)("div",{className:"d-flex justify-content-around",children:[Object(ht.jsx)(Lt.a,{disabled:!t.length,type:"primary",onClick:O,children:"Remove files"}),Object(ht.jsx)(Lt.a,{disabled:!l||!t.length,type:"primary",onClick:function(){m(function(e,t){return function(n){me.sendPhotos(e,t).then((function(e){var t=e.data;"\u0424\u0430\u0439\u043b\u044b \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b"===t&&n(Ee("success")),"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u043e\u0432"===t&&n(Ee("error"))})).catch((function(e){n(Ee("error")),console.error("Error when getting Preview: "+e)}))}}(t,l)),O(),r(["folders"])},children:"Upload files"})]})},"buttons-menu"):""]})})},Rt=n(357).a.DirectoryTree,Wt=function(e){var t=e.isMainPage,n=Object(s.c)(H).folderTree,a=Object(s.b)();return Object(ht.jsx)(Rt,{onSelect:function(e){var i=Object(O.a)(Be)(n);Object(m.a)(a,Je,i)(e[0].toString()),t&&a(bt())},treeData:n})},Gt=n(351),Bt=n(70),Yt=n(369),qt=n(177),zt=n.n(qt),Zt=function(e){var t=e.isMainPage,n=Object(s.b)(),i=Object(s.c)(H),r=i.folderTree,c=i.currentFolderPath,o=Object(s.c)(Q),l=Object(s.c)(ae),u=Object(a.useMemo)((function(){return C(c)}),[c]),d=Object(a.useMemo)((function(){return o.includes(u)}),[u,o]);return Object(ht.jsxs)("div",{className:zt.a.folderWrapper,children:[Object(ht.jsx)(Wt,{isMainPage:t}),Object(ht.jsxs)("div",{className:"d-flex align-items-center",children:[Object(ht.jsx)("span",{className:zt.a.label,children:"Directory:"}),Object(ht.jsx)(Gt.a,{className:"flex-1",options:l,defaultValue:c,value:c,onChange:function(e){n(Je(e))},filterOption:function(e,t){return-1!==(null===t||void 0===t?void 0:t.value.toUpperCase().indexOf(e.toUpperCase()))}}),Object(ht.jsx)(Bt.a,{title:"add Directory",className:zt.a.plusIcon,children:Object(ht.jsx)(Lt.a,{onClick:function(){""!==c&&(n(Ve([].concat(Object(Ke.a)(o),[u]))),n(Ze(Ge(u,r))))},disabled:d,type:"primary",shape:"circle",icon:Object(ht.jsx)(Yt.a,{})})})]})]})},Jt=n(356),Vt=n(228),Ht=n(374),Qt=n(217),Xt=n.n(Qt),$t=Jt.a.Dragger,en=function(e){var t=e.openMenus,n=Object(s.c)(H).currentFolderPath,i=Object(s.b)(),r=Object(a.useMemo)((function(){return t.includes("edit")}),[t]),c=Object(a.useMemo)((function(){return t.includes("template")}),[t]),o={accept:"image/*, video/*",className:Et()(Xt.a.dropZone,{active:r||c}),name:"file",multiple:!0,showUploadList:!1,headers:{path:n,"Content-Type":"application/json"},customRequest:function(e){var t;i((t=e.file,function(e){var n=t.lastModified,a=t.name,i=t.size,r=t.type;me.sendPhoto(t).then((function(t){var c=t.data,s=c.preview,o=c.tempPath;e(ve({changeDate:n,name:a,size:i,type:r,preview:s,tempPath:o,originalDate:"-",keywords:null,megapixels:""}))})).catch((function(e){return ge(e,"Error when getting Preview: ")}))})),i(Ee("empty"))},onChange:function(e){var t=e.file.status;"uploading"!==t&&console.log(e.file,e.fileList),"done"===t&&Vt.b.success("".concat(e.file.name," file uploaded successfully.")),"error"===t&&Vt.b.error("".concat(e.file.name," file upload failed."))}};return Object(ht.jsxs)($t,Object(u.a)(Object(u.a)({},o),{},{children:[Object(ht.jsx)("p",{className:"ant-upload-drag-icon",children:Object(ht.jsx)(Ht.a,{})}),Object(ht.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),Object(ht.jsx)("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload."})]}))},tn=n(360),nn=n(218),an=n(219),rn=n.n(an),cn=n(71),sn=n.n(cn),on=function(e){var t=e.openMenus,n=e.imageArr,i=e.fullExifFilesList,r=e.selectedList,c=e.addToSelectedList,s=e.removeFromSelectedList,o=e.clearSelectedList,l=e.updateFiles,d=e.isLoading,j=e.isMainPage,f=Object(a.useState)(""),b=Object(vt.a)(f,2),p=b[0],O=b[1],h=Object(a.useState)(!1),g=Object(vt.a)(h,2),x=g[0],v=g[1],w=Object(a.useState)(!1),P=Object(vt.a)(w,2),L=P[0],F=P[1],S=Object(a.useState)(!1),_=Object(vt.a)(S,2),M=_[0],k=_[1],N=Object(a.useState)(!0),E=Object(vt.a)(N,2),D=E[0],T=E[1],K=Object(a.useState)(!0),C=Object(vt.a)(K,2),A=C[0],I=C[1],U=Object(a.useState)(0),R=Object(vt.a)(U,2),W=R[0],G=R[1],B=Object(a.useState)([]),Y=Object(vt.a)(B,2),q=Y[0],z=Y[1],Z=Object(a.useMemo)((function(){return t.includes("edit")}),[t]),J=Object(a.useMemo)((function(){return t.includes("template")}),[t]),V=Object(a.useMemo)((function(){return i[p]}),[i,p]),H=function(){k(!0),T(!1),I(!1)},Q=Object(a.useCallback)((function(e,t){return Object(ht.jsx)(ht.Fragment,{children:M?Object(ht.jsx)(nn.a,{url:e,width:"80vm",id:"myId",className:sn.a.iframeStyles,position:"relative"}):Object(ht.jsxs)("div",{children:[Object(ht.jsx)("div",{className:sn.a.playButton,onClick:H}),Object(ht.jsx)("img",{src:t,alt:"video-preview"})]})})}),[M]);Object(a.useEffect)((function(){j&&z(n.map((function(e){return Object(u.a)({thumbnail:e.preview,original:e.originalPath||""},e.type.startsWith("video")&&{renderItem:function(){return Q(e.originalPath||"",e.preview)}})})))}),[n,j,M,Q]);return Object(ht.jsx)(wt.a,{className:sn.a.spinner,spinning:d,size:"large",children:Object(ht.jsxs)("div",{className:Et()(sn.a.wrapper,"d-grid"),children:[n.map((function(e,t){var n=e.preview,a=e.name,u=e.tempPath;return Object(ht.jsxs)("div",{className:Et()(sn.a.item,{active:r.includes(t),pointer:Z||J},"position-relative"),onClick:function(){return function(e,t){var n=function(){c(e),l(t)};Z&&(o(),n()),J&&(r.includes(e)?s(e):n()),!Z&&!J&&(F(!0),G(e))}(t,u)},children:[Object(ht.jsxs)("div",{className:Et()(sn.a.imgInfo,"".concat(Z||J?"d-none":"d-flex"," "),"position-absolute align-items-center"),children:[Object(ht.jsx)("h3",{style:{width:"70%"},className:sn.a.imgName,children:a}),Object(ht.jsx)("h3",{style:{marginLeft:"auto"},className:Et()(sn.a.imgName,"pointer"),onClick:function(e){return function(e,t){e.stopPropagation(),!i[t]&&l(t),O(t),v(!0)}(e,u)},children:"Exif"})]}),Object(ht.jsx)("img",{className:sn.a.img,src:n,alt:"image-preview"})]},n)})),Object(ht.jsx)(tn.a,{title:"Exif list",footer:null,visible:x,onCancel:function(){return v(!1)},children:Object(m.a)(Object(y.a)((function(e){return Object(ht.jsxs)("div",{children:[Object(ht.jsx)("span",{className:"bold",children:e+":"}),Object(ht.jsx)("span",{style:{marginLeft:5},children:V[e]})]},e)})),be.a)(V)}),j?Object(ht.jsx)(tn.a,{visible:L,wrapClassName:"image-modal",closable:!1,centered:!0,width:"90%",footer:null,onCancel:function(){return F(!1)},children:Object(ht.jsx)(rn.a,{items:q,slideDuration:0,slideInterval:3e3,startIndex:W,showThumbnails:!1,onSlide:function(e){G(e),T(!0),I(!0),k(!1)},showPlayButton:D,showFullscreenButton:A,showIndex:!0})}):""]})})},ln=n(78),un=n(358),dn=n(352),jn=n(353),fn=n(365),bn=n(363),pn=n(355),On=n(178),mn=n.n(On),hn=ln.a.Option,gn={name:"-",originalDate:"",filePath:"",keywords:[],isName:!1,isOriginalDate:!1,isFilePath:!1,isKeywords:!1},xn={title:"Duplicate names",content:"Please enter another name"},yn={title:"Nothing to edit",content:"Please check one of the checkboxes"},vn=function(e,t,n,a){var i=Object(m.a)(C,A)(a);return"".concat(i,"/").concat(e?t:n)},wn=function(e){var t=e.filesArr,n=e.selectedList,i=e.sameKeywords,r=e.isEditMany,c=e.selectAll,o=e.clearAll,l=e.isExifLoading,d=e.allKeywords,j=e.isMainPage,f=un.a.useForm(),h=Object(vt.a)(f,1)[0],g=tn.a.useModal(),x=Object(vt.a)(g,2),y=x[0],v=x[1],w=Object(s.b)(),F=Object(s.c)(ae),S=Object(a.useState)(""),_=Object(vt.a)(S,2),M=_[0],k=_[1],N=Object(a.useState)(!0),E=Object(vt.a)(N,2),D=E[0],C=E[1],R=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,r=Object(s.b)(),c=Object(a.useMemo)((function(){return i?it:we}),[i]);return Object(a.useMemo)((function(){var a=t.filter((function(t,n){return e.includes(n)})),s=Y(n,a),o=Object(O.a)((function(e,t){var n=(null===t||void 0===t?void 0:t.keywords)||[];return(Object(b.a)(n)?e:q(n,e)).map((function(e){return Object(u.a)(Object(u.a)({},e),Object(p.a)(["keywords"],t))}))}))(s),l=Object(O.a)(z)(i?"_id":"tempPath",t);return Object(m.a)(r,c,l,B,o)}),[t,n,i,r,c,e])}(n,t,i,j),W=Object(a.useMemo)((function(){return n.length?t[I(n)]:gn}),[t,n]),G=W.name,Z=W.originalDate,J=Object(a.useMemo)((function(){return!n.length}),[n]),H=Object(a.useMemo)((function(){return U(G)}),[G]),Q=H.shortName,X=H.ext;Object(a.useEffect)((function(){j&&n.length&&k(function(){var e=t[I(n)].filePath||"";return Object(m.a)(V,A)(e)}())}),[t,j,n]),Object(a.useEffect)((function(){!n.length&&C(!0),n.length===t.length&&C(!1)}),[n.length,t.length]),Object(a.useEffect)((function(){h.setFieldsValue({name:Q,originalDate:"-"===Z?"":P()(Z,T),keywords:Object(Ae.a)(Ie.a,i||[]),filePath:M,isName:!1,isOriginalDate:!1,isKeywords:!1,isFilePath:!1})}),[h,Q,Z,i,M]);var $=function(e,a,r,c,s){var o=t.filter((function(e,t){return n.includes(t)})).map((function(t){return{_id:t._id,keywords:t.keywords,name:e}})),l=B(o).map((function(e){return e.name})),u=function(e,t){var n=K(e);return Object(b.a)(t)?n:q(t,n)}(Y(i,o),c).map((function(e){return e.keywords||[]})),d=function(e){var t=s.isName,n=s.isOriginalDate,i=s.isKeywords,c=s.isFilePath;return{originalName:t&&!l[e].startsWith("-")?l[e]:void 0,originalDate:n&&a||void 0,keywords:i?u[e]:void 0,filePath:c?r:void 0}},j=o.map((function(e,t){return{id:e._id||"",updatedFields:d(t)}}));j.length&&w(pt(j))};return Object(ht.jsxs)("div",{children:[Object(ht.jsxs)(un.a,{form:h,name:"editForm",onFinish:function(e){var n=e.name,a=e.originalDate,c=e.keywords,s=e.isName,o=e.filePath,l=e.isOriginalDate,u=e.isKeywords,d=e.isFilePath,f=n?n+X:"",p=a?P()(a).format(T):null,m=Object(O.a)((function(e,t){return e.map((function(e){return e.name})).includes(t)}))(t),h=!r&&s&&m(f),g=!s&&!l&&!u&&!d;h&&y.warning(xn),g&&y.warning(yn),!h&&!g&&function(){var e=Object(O.a)(vn)(s,f,G),t={name:s&&n?f:void 0,originalDate:l?p:void 0,keywords:u?c:Object(Ae.a)(Ie.a,i||[]),filePath:d&&o?e(o):void 0},a={isName:s,isOriginalDate:l,isKeywords:u,isFilePath:d};j&&$(f,p,"/".concat(o),c,a);var r,m=(r=t,Object(L.a)((function(e){return!e}))(r));!Object(b.a)(m)&&R(m)}()},children:[Object(ht.jsxs)(dn.a,{className:mn.a.item,gutter:10,children:[Object(ht.jsx)(jn.a,{span:8,offset:1,style:{textAlign:"left"},children:Object(ht.jsx)(un.a.Item,{name:"isName",valuePropName:"checked",children:Object(ht.jsx)(fn.a,{children:"Name:"})})}),Object(ht.jsx)(jn.a,{span:12,children:Object(ht.jsx)(un.a.Item,{name:"name",children:Object(ht.jsx)(bn.a,{placeholder:"Edit name",disabled:J,allowClear:!0})})}),Object(ht.jsx)(jn.a,{span:3,children:Object(ht.jsx)("span",{className:Et()(mn.a.extension,"d-block"),children:X})})]}),Object(ht.jsxs)(dn.a,{gutter:10,children:[Object(ht.jsx)(jn.a,{span:8,offset:1,style:{textAlign:"left"},children:Object(ht.jsx)(un.a.Item,{name:"isOriginalDate",valuePropName:"checked",children:Object(ht.jsx)(fn.a,{children:"OriginalDate:"})})}),Object(ht.jsx)(jn.a,{span:14,children:Object(ht.jsx)(un.a.Item,{name:"originalDate",children:Object(ht.jsx)(pn.a,{format:T,placeholder:"Edit date",disabled:J,className:"w-100"})})})]}),j?Object(ht.jsxs)(dn.a,{gutter:10,children:[Object(ht.jsx)(jn.a,{span:8,offset:1,style:{textAlign:"left"},children:Object(ht.jsx)(un.a.Item,{name:"isFilePath",valuePropName:"checked",children:Object(ht.jsx)(fn.a,{children:"File path:"})})}),Object(ht.jsx)(jn.a,{span:14,children:Object(ht.jsx)(un.a.Item,{name:"filePath",children:Object(ht.jsx)(Gt.a,{disabled:J,placeholder:"Edit file path",options:F,onChange:function(e){return k(e)},filterOption:function(e,t){return-1!==(null===t||void 0===t?void 0:t.value.toUpperCase().indexOf(e.toUpperCase()))}})})})]}):"",Object(ht.jsxs)(dn.a,{gutter:10,children:[Object(ht.jsx)(jn.a,{span:8,offset:1,style:{textAlign:"left"},children:Object(ht.jsx)(un.a.Item,{name:"isKeywords",valuePropName:"checked",children:Object(ht.jsx)(fn.a,{children:"Keywords:"})})}),Object(ht.jsx)(jn.a,{span:14,children:Object(ht.jsx)(un.a.Item,{name:"keywords",children:Object(ht.jsx)(ln.a,{className:mn.a.keywords,mode:"tags",placeholder:"Edit keywords",disabled:J,children:d&&d.map((function(e){return Object(ht.jsx)(hn,{value:e,children:e},e)}))})})})]}),Object(ht.jsxs)(dn.a,{gutter:10,children:[Object(ht.jsx)(jn.a,{span:7,offset:9,children:Object(ht.jsx)(un.a.Item,{children:Object(ht.jsx)(Lt.a,{className:"w-100",style:{marginRight:10},type:"primary",htmlType:"submit",disabled:J,children:"Edit"})})}),Object(ht.jsx)(jn.a,{span:7,children:Object(ht.jsx)(un.a.Item,{children:r?Object(ht.jsx)(Lt.a,{className:"w-100",onClick:function(){D&&c&&c(),!D&&o&&o(),C(!D)},type:"primary",loading:l,children:D?"Select all":"Unselect all"}):""})})]})]}),v]})},Pn=n(366),Ln=n(171),Fn=n(221),Sn=n.n(Fn),_n=function(e){var t=e.message,n=e.hide,a=e.type;return Object(ht.jsx)(Pn.a,{className:Et()(Sn.a.alert,{hide:n},"justify-content-center"),message:t,type:a,icon:Object(ht.jsx)(Ln.a,{}),showIcon:!0})},Mn=n(354),kn=n(134),Nn=n.n(kn),En=ln.a.Option,Dn=function(){var e=Object(s.b)(),t=Object(s.c)(H).keywordsList,n=Object(s.c)(ee),i=n.searchTags,r=n.excludeTags,c=Object(a.useMemo)((function(){return Object(Mn.a)(t,r)}),[r,t]),o=Object(a.useMemo)((function(){return Object(Mn.a)(t,i)}),[i,t]);return Object(ht.jsxs)("div",{className:Nn.a.wrapper,children:[Object(ht.jsx)("span",{className:Nn.a.title,children:"Search tags:"}),Object(ht.jsx)(ln.a,{className:Et()(Nn.a.select,"w-100"),mode:"tags",placeholder:"choose Keywords",onChange:function(t){e(ot(t)),e(bt())},children:c.map((function(e){return Object(ht.jsx)(En,{value:e,children:e},e)}))}),Object(ht.jsx)("span",{className:Nn.a.title,children:"Exclude tags:"}),Object(ht.jsx)(ln.a,{className:"w-100",mode:"tags",placeholder:"choose Keywords",onChange:function(t){e(lt(t)),e(bt())},children:o.map((function(e){return Object(ht.jsx)(En,{value:e,children:e},e)}))})]})},Tn=l.a.Content,Kn={success:"Files uploaded successfully",error:"Submission Failed",loading:"",empty:""},Cn=function(){var e=Object(s.b)(),t=Object(s.c)(X),n=t.isExifLoading,i=t.uploadingStatus,r=Object(s.c)(ce),c=Object(s.c)(oe),o=Object(s.c)(ie),j=o.openMenus,f=o.selectedList,b=o.imageArr,p=Object(s.c)(H).currentFolderPath,O=mt(b).updateUploadingFiles,m=Object(u.a)(Object(u.a)({},o),{},{removeFromSelectedList:function(t){return e(Fe(t))},addToSelectedList:function(t){return e(Le(t))},clearSelectedList:function(){return e(Se())},updateFiles:function(e){return O(e)},isLoading:!1}),h={filesArr:b,selectedList:f,isExifLoading:n,uniqKeywords:r,sameKeywords:c,openKeys:j,currentFolderPath:p,clearSelectedList:function(){return e(Se())},selectAll:function(){e(_e()),O("_",!0)},updateOpenMenus:function(t){return e(Me(t))},updateKeywords:function(){return O("_",!0)},removeKeyword:function(t){var n=Y([t],b);e(we(n))},removeFiles:function(){return e(ke())}},g=Object(a.useMemo)((function(){var e,t="empty"!==(e=i)&&"loading"!==e?e:null;return t?Object(ht.jsx)(d.a,{status:t||"info",title:Kn[i]}):""}),[i]);return Object(ht.jsxs)(l.a,{children:[Object(ht.jsx)(Ut,Object(u.a)({},h)),Object(ht.jsx)(l.a,{children:Object(ht.jsxs)(Tn,{children:[Object(ht.jsx)(en,{openMenus:j}),g,Object(ht.jsx)(_n,{message:"Edit mode",hide:!j.includes("edit"),type:"info"}),Object(ht.jsx)(_n,{message:"Template mode",hide:!j.includes("template"),type:"success"}),Object(ht.jsx)(on,Object(u.a)({},m))]})})]})},An=n(361),In=["30","60","100","200"],Un=function(){var e=Object(s.b)(),t=Object(s.c)(ne),n=t.currentPage,a=t.resultsCount,i=t.nPerPage;return Object(ht.jsx)(An.a,{style:{margin:"10px 0 0 20px"},total:a,showTotal:function(e){return"Total ".concat(e," items")},pageSize:i,current:n,showSizeChanger:!0,pageSizeOptions:In,onChange:function(t,n){var a=Object(u.a)({currentPage:n===i?t:1},n&&{nPerPage:n});e(dt(a)),e(bt())}})},Rn=l.a.Content,Wn=function(){var e=Object(s.b)(),t=Object(a.useState)(!1),n=Object(vt.a)(t,2),i=n[0],r=n[1],c=Object(s.c)(ee),o=c.isExifLoading,d=c.isGalleryLoading,j=Object(s.c)(se),f=Object(s.c)(le),p=Object(s.c)(re),O=p.openMenus,m=p.selectedList,h=p.imageArr,g=Object(s.c)(H).currentFolderPath,x=mt(h).updateUploadingFiles;Object(a.useEffect)((function(){Object(b.a)(h)&&!i&&e(bt()),r(!0)}),[e,h,i]);var y=Object(u.a)(Object(u.a)({},p),{},{removeFromSelectedList:function(t){return e(nt(t))},addToSelectedList:function(t){return e(tt(t))},clearSelectedList:function(){return e(ct())},updateFiles:function(e){return x(e)},isLoading:d,isMainPage:!0}),v={filesArr:h,selectedList:m,isExifLoading:o,uniqKeywords:j,sameKeywords:f,openKeys:O,currentFolderPath:g,clearSelectedList:function(){return e(ct())},selectAll:function(){e(st()),x("_",!0)},updateOpenMenus:function(t){return e(rt(t))},updateKeywords:function(){return x("_",!0)},removeKeyword:function(t){var n=Y([t],h);e(it(n))},removeFiles:function(){return e(ut())}};return Object(ht.jsxs)(l.a,{children:[Object(ht.jsx)(Ut,Object(u.a)({},v)),Object(ht.jsx)(l.a,{children:Object(ht.jsxs)(Rn,{children:[Object(ht.jsx)(_n,{message:"Edit mode",hide:!O.includes("edit"),type:"info"}),Object(ht.jsx)(_n,{message:"Template mode",hide:!O.includes("template"),type:"success"}),Object(ht.jsx)(Un,{}),Object(ht.jsx)(on,Object(u.a)({},y)),Object(ht.jsx)(Un,{})]})})]})};var Gn=function(){return Object(ht.jsxs)(l.a,{children:[Object(ht.jsx)(yt,{}),Object(ht.jsxs)(o.c,{children:[Object(ht.jsx)(o.a,{exact:!0,path:"/IDB_Front_2.0/upload",component:Cn}),Object(ht.jsx)(o.a,{component:Wn})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||/^127(?:\.(?:25[0-5]|2[0-4]\d|[01]?\d{1,2})){3}$/.test(window.location.hostname));var Bn=n(68),Yn=Object(Bn.b)({folderReducer:Qe,uploadReducer:De,mainPageReducer:ft}),qn=Object(fe.a)({reducer:Yn});n(333),n(334),n(335);r.a.render(Object(ht.jsx)(s.a,{store:qn,children:Object(ht.jsx)(c.a,{children:Object(ht.jsx)(Gn,{})})}),document.querySelector("#root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},71:function(e,t,n){e.exports={spinner:"Gallery_spinner__yldZq",wrapper:"Gallery_wrapper__2zUVk",item:"Gallery_item__bdOQj",imgInfo:"Gallery_imgInfo__n8Dj2",imgName:"Gallery_imgName__tKtw7",img:"Gallery_img__2JlhP",iframeStyles:"Gallery_iframeStyles__3KqeT",playButton:"Gallery_playButton__3bHoN"}}},[[336,1,2]]]);
//# sourceMappingURL=main.da6cc624.chunk.js.map